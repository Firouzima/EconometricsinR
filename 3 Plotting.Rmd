---
title: "3 Plotting"
author: "Mohammadamin Firouzi"
date: "2025-02-20"
---

# Plotting

#### Basic graphs

```{r}

curve(x^2, -2, 2) # curve( function(x), xmin, xmax )
curve(log(x))
curve(exp(x))
curve(x^3, -5, 5)

data(wage1, package = "wooldridge")
plot(wage1$educ, wage1$wage) # plot(x,y)

```

The most fundamental option of these plots is the type. It can take the values "p" (the default), "l", "b", "o", "s", "h", and more.

```{r}

x = c(1, 2, 3, 4, 5)
y = c(3, 5, 1, 2, 3)

plot(x, y, type = "l")
plot(x, y, type = "l", lty = 3) # The line type can be changed using the option lty.
plot(x, y, type = "l", lty = 6)
plot(x, y, type = "l", lty = 6, lwd = 3) # The width of the lines can be changed using the option lwd


plot(x, y, type = "b")
plot(x, y, type = "b", pch = 8) # The point symbol can be changed using the option pch.
plot(x, y, type = "b", pch = 11)
plot(x, y, type = "b", pch = 11, cex = 1) # The size of the points and texts can be changed using the option cex.

```

#### Colors

```{r}

colors()
plot(x, y, type = "l", col = "sienna", lwd = 2)
plot(x, y, type = "l", col = 500, lwd = 2)
plot(x, y, type = "l", col = "#562421" , lwd = 2) # By RGB values with a string of the form "#RRGGBB" 
plot(x, y, type = "l", col = rgb(red = 0.85, green = 1, blue = 0.75, alpha = 0.75) , lwd = 3)

plot(wage1$wage ~ wage1$exper, pch = 20, col = 'steelblue',
     main = '', xlab = 'Exper',  ylab = 'Wage', cex = 0.75)
title(main = list('Wage vs. Experience', cex = 1, col = 'red', font = 2))
abline(a = 5.37331, b = 0.03072, lwd = 2, col = 'green')
```

#### ggplot basics

```{r message=FALSE, warning=FALSE}

#install.packages(ggplot2)
library(ggplot2)

set.seed(123)
educ = rnorm(200, 10, 2)
wage = 2 + 1.5 * educ + rnorm(200, 1, 5)
data = data.frame(wage, educ)

d = rnorm(200, 1)
library(tidyverse)
data$gender = ifelse(d >= 1, 1, 0)
data$gender = factor(data$gender, levels = c('0', '1'), labels = c('Female', 'Male'))

ggplot() +
  geom_point(data = data, mapping = aes(x = educ, y = wage))

ggplot() +
  geom_point(data = data, mapping = aes(x = educ, y = wage)) + 
  geom_smooth(data = data, mapping = aes(x = educ, y = wage), method = "lm")

ggplot(data, aes(x = educ, y = wage)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE)
```

#### Colors and shapes in ggplot graphs

```{r}

ggplot(data, aes(x = educ, y = wage)) +
  geom_point(aes(alpha = gender))

ggplot(data, aes(x = educ, y = wage)) +
  geom_point(aes(shape = gender))

ggplot(data, aes(x = educ, y = wage)) +
  geom_point(aes(colour = gender))

ggplot(data, aes(x = educ, y = wage)) +
  geom_point(color = "darkorange") + 
  geom_smooth(method = "lm", se = FALSE, color = "darkmagenta")

ggplot(data, aes(x = educ, y = wage)) +
  geom_point(aes(color = gender)) +
  geom_smooth(method = "lm", color = "plum", se = FALSE)

ggplot(data, aes(x = educ, y = wage)) +
  geom_point(aes(color = gender)) +
  geom_smooth(method = "lm", color = "plum", se = FALSE) +
  scale_color_grey() +
  scale_shape_manual(values = 1:2)

ggplot(data, aes(x = educ, y = wage)) +
  geom_point(aes(color = gender)) +
  geom_smooth(method = "lm", se = FALSE) +
  theme_light() +
  labs(title = "Wage vs. Education",
       caption = "Source = Wooldridge 2019",
       x = "Education in years",
       y = "Wage in $",
       color = "Gender") +
  # coord_cartesian(xlim = c(0, 20), ylim = c(0, 20))
  theme(legend.position = c(0.15, 0.85))
```

#### Overplotting

You can avoid this gridding by setting the position adjustment to “jitter.” position = "jitter" adds a small amount of random noise to each point.

Adding randomness seems like a strange way to improve your plot, but while it makes your graph less accurate at small scales, it makes your graph more revealing at large scales.

```{r}

ggplot(wage1, aes(x = educ, y = wage)) + geom_point()

ggplot(wage1, aes(x = educ, y = wage)) + geom_point(position = 'jitter')


```

#### Facet

```{r}

ggplot(wage1, aes(x = educ, y = wage)) +
  geom_point() +
  facet_wrap(~ nonwhite)

ggplot(wage1, aes(x = tenure, y = wage)) +
  geom_point(color = "lightgreen") +
  facet_wrap(~ educ, ncol = 6) +
  theme_light()

ggplot(wage1, aes(x = educ, y = wage)) +
  geom_point() +
  facet_grid(married ~ female + nonwhite) +
  theme_dark()
```

#### geom_smooth

```{r}

ggplot(wage1, aes(x = educ, y = wage)) +
  geom_point(aes(colour = factor(married))) +
  geom_smooth(method = "lm", se = FALSE, aes(linetype = factor(married),
                                             color = factor(married))) +
  theme_light()
```

#### Save plot

```{r}

ggsave("my_plot.png", width = 7, height = 5)
ggsave("my_plot.png", width = 7, height = 5, dpi = 600)
ggsave("my_plot.eps", width = 7, height = 5)
ggsave("my_plot.pdf", width = 7, height = 5) 
```
